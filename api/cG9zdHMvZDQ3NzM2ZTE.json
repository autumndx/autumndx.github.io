{"title":"数据库系统概论（第五版）课后答案","date":"2021-04-08T12:14:29.000Z","date_formatted":{"ll":"2021年4月8日","L":"2021/04/08","MM-DD":"04-08"},"link":"posts/d47736e1","comments":true,"tags":["SQL"],"updated":"2021-04-08T12:16:30.614Z","content":"<blockquote>\n<p>P71 第六题 P130 第五题 </p>\n</blockquote>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> S</span><br><span class=\"line\">  (SNO <span class=\"built_in\">CHAR</span>(<span class=\"number\">2</span>)PRIMARY <span class=\"keyword\">KEY</span>,</span><br><span class=\"line\">  SNAME <span class=\"built_in\">CHAR</span>(<span class=\"number\">6</span>),</span><br><span class=\"line\">  <span class=\"keyword\">STATUS</span> <span class=\"built_in\">SMALLINT</span>,</span><br><span class=\"line\">  CITY <span class=\"built_in\">CHAR</span>(<span class=\"number\">4</span>),</span><br><span class=\"line\">  );</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> P</span><br><span class=\"line\">  (PNO <span class=\"built_in\">CHAR</span>(<span class=\"number\">2</span>)PRIMARY <span class=\"keyword\">KEY</span>,</span><br><span class=\"line\">  PNAME <span class=\"built_in\">CHAR</span>(<span class=\"number\">10</span>),</span><br><span class=\"line\">  COLOR <span class=\"built_in\">CHAR</span>(<span class=\"number\">2</span>),</span><br><span class=\"line\">  WEIGHT <span class=\"built_in\">SMALLINT</span>,</span><br><span class=\"line\">  );</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> J</span><br><span class=\"line\">  (JNO <span class=\"built_in\">CHAR</span>(<span class=\"number\">2</span>)PRIMARY <span class=\"keyword\">KEY</span>,</span><br><span class=\"line\">  JNAME <span class=\"built_in\">CHAR</span>(<span class=\"number\">10</span>),</span><br><span class=\"line\">  CITY  <span class=\"built_in\">CHAR</span>(<span class=\"number\">4</span>),</span><br><span class=\"line\">  );</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> SPJ</span><br><span class=\"line\">  (SNO <span class=\"built_in\">CHAR</span>(<span class=\"number\">2</span>),</span><br><span class=\"line\">  PNO <span class=\"built_in\">CHAR</span>(<span class=\"number\">2</span>),</span><br><span class=\"line\">  JNO <span class=\"built_in\">CHAR</span>(<span class=\"number\">2</span>),</span><br><span class=\"line\">  QTY <span class=\"built_in\">SMALLINT</span>,</span><br><span class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span>(SNO,PNO,JNO),</span><br><span class=\"line\">  <span class=\"keyword\">FOREIGN</span> <span class=\"keyword\">KEY</span>(SNO)<span class=\"keyword\">REFERENCES</span> S(SNO),</span><br><span class=\"line\">  <span class=\"keyword\">FOREIGN</span> <span class=\"keyword\">KEY</span>(PNO)<span class=\"keyword\">REFERENCES</span> P(PNO),</span><br><span class=\"line\">  <span class=\"keyword\">FOREIGN</span> <span class=\"keyword\">KEY</span>(JNO)<span class=\"keyword\">REFERENCES</span> J(JNO))</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> S</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S1'</span>,<span class=\"string\">'精益'</span>,<span class=\"number\">20</span>,<span class=\"string\">'天津'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> S</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S2'</span>,<span class=\"string\">'盛锡'</span>,<span class=\"number\">10</span>,<span class=\"string\">'北京'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> S</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S3'</span>,<span class=\"string\">'东方红'</span>,<span class=\"number\">30</span>,<span class=\"string\">'北京'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> S</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S4'</span>,<span class=\"string\">'丰盛泰'</span>,<span class=\"number\">20</span>,<span class=\"string\">'天津'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> S</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S5'</span>,<span class=\"string\">'为民'</span>,<span class=\"number\">30</span>,<span class=\"string\">'上海'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> P</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'P1'</span>,<span class=\"string\">'螺母'</span>,<span class=\"string\">'红'</span>,<span class=\"number\">12</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> P</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'P2'</span>,<span class=\"string\">'螺栓'</span>,<span class=\"string\">'绿'</span>,<span class=\"number\">17</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> P</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'P3'</span>,<span class=\"string\">'螺丝刀'</span>,<span class=\"string\">'蓝'</span>,<span class=\"number\">14</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> P </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'P4'</span>,<span class=\"string\">'螺丝刀'</span>,<span class=\"string\">'红'</span>,<span class=\"number\">14</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> P</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'P5'</span>,<span class=\"string\">'凸轮'</span>,<span class=\"string\">'蓝'</span>,<span class=\"number\">40</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> P</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'P6'</span>,<span class=\"string\">'齿轮'</span>,<span class=\"string\">'红'</span>,<span class=\"number\">30</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S1'</span>,<span class=\"string\">'P1'</span>,<span class=\"string\">'J1'</span>,<span class=\"number\">200</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S1'</span>,<span class=\"string\">'P1'</span>,<span class=\"string\">'J3'</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S1'</span>,<span class=\"string\">'P1'</span>,<span class=\"string\">'J4'</span>,<span class=\"number\">700</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S1'</span>,<span class=\"string\">'P2'</span>,<span class=\"string\">'J2'</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S2'</span>,<span class=\"string\">'P3'</span>,<span class=\"string\">'J1'</span>,<span class=\"number\">400</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S2'</span>,<span class=\"string\">'P3'</span>,<span class=\"string\">'J2'</span>,<span class=\"number\">200</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S2'</span>,<span class=\"string\">'P3'</span>,<span class=\"string\">'J4'</span>,<span class=\"number\">500</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S2'</span>,<span class=\"string\">'P3'</span>,<span class=\"string\">'J5'</span>,<span class=\"number\">400</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S2'</span>,<span class=\"string\">'P5'</span>,<span class=\"string\">'J1'</span>,<span class=\"number\">400</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S2'</span>,<span class=\"string\">'P5'</span>,<span class=\"string\">'J2'</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S3'</span>,<span class=\"string\">'P1'</span>,<span class=\"string\">'J1'</span>,<span class=\"number\">200</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ </span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S3'</span>,<span class=\"string\">'P3'</span>,<span class=\"string\">'J1'</span>,<span class=\"number\">200</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S4'</span>,<span class=\"string\">'P5'</span>,<span class=\"string\">'J1'</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S4'</span>,<span class=\"string\">'P6'</span>,<span class=\"string\">'J3'</span>,<span class=\"number\">300</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S4'</span>,<span class=\"string\">'P6'</span>,<span class=\"string\">'J4'</span>,<span class=\"number\">200</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S5'</span>,<span class=\"string\">'P2'</span>,<span class=\"string\">'J4'</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S5'</span>,<span class=\"string\">'P3'</span>,<span class=\"string\">'J1'</span>,<span class=\"number\">200</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S5'</span>,<span class=\"string\">'P6'</span>,<span class=\"string\">'J2'</span>,<span class=\"number\">200</span>);</span><br><span class=\"line\">  <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> SPJ</span><br><span class=\"line\">  <span class=\"keyword\">VALUES</span>(<span class=\"string\">'S5'</span>,<span class=\"string\">'P6'</span>,<span class=\"string\">'J4'</span>,<span class=\"number\">500</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">SELECT</span> JNAME, CITY <span class=\"keyword\">FROM</span> J;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">SELECT</span> PNAME, COLOR, WEIGHT <span class=\"keyword\">FROM</span> P;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">SELECT</span> JNO <span class=\"keyword\">FROM</span> SPJ <span class=\"keyword\">WHERE</span> SNO=<span class=\"string\">'S1'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">SELECT</span> P.PNAME,SPJ.QTY <span class=\"keyword\">FROM</span> SPJ,P <span class=\"keyword\">WHERE</span>  P.PNO = SPJ.PNO <span class=\"keyword\">AND</span> SPJ.JNO = <span class=\"string\">'J2'</span> ;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span> PNO <span class=\"keyword\">FROM</span> SPJ,S <span class=\"keyword\">WHERE</span> S.CITY = <span class=\"string\">'上海'</span> <span class=\"keyword\">AND</span> SPJ.SNO = S.SNO;</span><br></pre></td></tr></table></figure>","prev":{"title":"Java笔记","link":"posts/b6543913"},"next":{"title":"SQL Sever笔记","link":"posts/ab4279d1"},"plink":"https://dxsummer.gitee.io/posts/d47736e1/","reward":true,"copyright":{"author":"DxSummer","link":"<a href=\"https://dxsummer.gitee.io/posts/d47736e1/\" title=\"数据库系统概论（第五版）课后答案\">https://dxsummer.gitee.io/posts/d47736e1/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"2021年4月8日","updated":"2021年4月8日"}}